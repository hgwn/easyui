<!--安全问题-->
<!-- accout_main S-->
<div class="accout_main">
   <!-- <div class="accout_headBar">
        <a href="#" class="visit">基本设置</a><span>&gt;</span>
        <a href="#" class="visit">安全中心</a><span>&gt;</span>
        <a href="#">安全问题</a>
    </div>-->

    <div class="accout_main_content">
        <div class="accout_main_title" style="padding-top: 15px;">安全问题</div>

        <div class="accout_basic_box">
            <form id="answer" style="display:none;">
                <ul class="accout_person_ul">
                    <li><span class="accout_person_n"><b>问题一：</b></span>
                        <select name="q1" id="q1" class="accout_person_text" style="width:285px; height:35px;">
                            <option value="1">您所上大学的名称</option>
                            <option value="2">您出生的医院是哪间</option>
                            <option value="3">您成长的街道叫什么路</option>
                            <option value="4">您就读的第一所学校名称是</option>
                            <option value="5">您的初恋情人叫什么名字</option>
                            <option value="6">您就职的第一家公司名称</option>
                            <option value="7">您父亲的姓名</option>
                            <option value="8">您母亲的姓名</option>
                            <option value="9">您父亲的生日</option>
                            <option value="10">您母亲的生日</option>
                            <option value="11">您配偶的姓名</option>
                        </select>
                    </li>
                    <li><span class="accout_person_n">答案：</span>
                        <input id="a1" type="text" class="accout_person_text"/>
                    </li>
                    <li><span class="accout_person_n"><b>问题二：</b></span>
                        <select name="q2" id="q2"class="accout_person_text" style="width:285px; height:35px;">
                        <option value="1">您所上大学的名称</option>
                        <option value="2">您出生的医院是哪间</option>
                        <option value="3">您成长的街道叫什么路</option>
                        <option value="4">您就读的第一所学校名称是</option>
                        <option value="5">您的初恋情人叫什么名字</option>
                        <option value="6">您就职的第一家公司名称</option>
                        <option value="7">您父亲的姓名</option>
                        <option value="8">您母亲的姓名</option>
                        <option value="9">您父亲的生日</option>
                        <option value="10">您母亲的生日</option>
                        <option value="11">您配偶的姓名</option>
                    </select></li>
                    <li><span class="accout_person_n">答案：</span>
                        <input id="a2" type="text" class="accout_person_text"/>
                    </li>
                    <li><span class="accout_person_n"><b>问题三：</b></span>
                        <select name="q3" id="q3" class="accout_person_text" style="width:285px; height:35px;">
                            <option value="1">您所上大学的名称</option>
                            <option value="2">您出生的医院是哪间</option>
                            <option value="3">您成长的街道叫什么路</option>
                            <option value="4">您就读的第一所学校名称是</option>
                            <option value="5">您的初恋情人叫什么名字</option>
                            <option value="6">您就职的第一家公司名称</option>
                            <option value="7">您父亲的姓名</option>
                            <option value="8">您母亲的姓名</option>
                            <option value="9">您父亲的生日</option>
                            <option value="10">您母亲的生日</option>
                            <option value="11">您配偶的姓名</option>
                        </select>
                    </li>
                    <li><span class="accout_person_n">答案：</span>
                        <input id="a3" type="text" class="accout_person_text"/>
                    </li>
                    <li class="accout_person_btn">
                        <button id="sumbitanswer" type="button" class="zc_btn">设置</button>
                    </li>
                </ul>

                <dl>
                    <dt>温馨提示：</dt>
                    <dd>1．请设置容易记忆的安全问题，并定期重新设置，避免遗忘。</dd>
                    <dd>2．请不要向外人透露您的安全问题答案。</dd>
                </dl>

            </form>


            <form id="answering" style="display:none;">
                <ul class="accout_person_ul">
                    <li><span class="accout_person_n"><b>问题一：</b></span><b id="q1question"></b></li>
                    <li><span class="accout_person_n">答案：</span><input type="text" id="q1answer" class="accout_person_text"/></li>
                    <li><span class="accout_person_n"><b>问题二：</b></span><b id="q2question"></b></li>
                    <li><span class="accout_person_n">答案：</span><input type="text" id="q2answer" class="accout_person_text"/></li>
                    <li><span class="accout_person_n"><b>问题三：</b></span><b id="q3question"></b></li>
                    <li><span class="accout_person_n">答案：</span><input type="text" id="q3answer"  class="accout_person_text"/></li>
                    <li class="accout_person_btn">
                        <button id="answerquestion" type="button" class="zc_btn">确定</button>
                    </li>
                </ul>
                <div class="cash_info" style="width: 460px;">
                    <span class="bg"></span>忘记安全问题答案？&nbsp;&nbsp;<a id="getEmailLink" href="javascript:void(0);" class="font_blue">点击邮箱重置安全问题 >></a>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    var question={
        init:function(){
            this.render();
        },
        render:function(){
            var url="/dlapi/uc/user/safe/"+user.data.name;
            DeelonService.ajax(url,'get',{},function(data){
                if(data.q1!=undefined){
                    $("#answering").show();
                    $("#answer").hide();
                    $("#q1question").html(data.q1);
                    $("#q2question").html(data.q2);
                    $("#q3question").html(data.q3);
                }else{
                    $("#answer").show();
                    $("#answering").hide();
                    $("#q1").val("1");
                    $("#q2").val("2");
                    $("#q3").val("3");
                }
            },function(xhr, status, err){});
        }
    };
    question.init();

    $("#sumbitanswer").on("click",function(){
        var q1=$("#q1 option:selected").text();
        var q2=$("#q2 option:selected").text();
        var q3=$("#q3 option:selected").text();
        var a1=$("#a1").val();
        var a2=$("#a2").val();
        var a3=$("#a3").val();
        var url="/dlapi/uc/user/safe/"+user.data.id;
        if(q1==q2||q2==q3||q1==q3){
            jAlert.warn("不能选择相同的问题");
        }else if(a1==''||a2==''||a3==''){
            jAlert.warn("答案不能为空");
        }else{
            DeelonService.putjSON(url,{q1:q1,q2:q2,q3:q3,a1:a1,a2:a2,a3:a3},function(data){
                if(data.code==0){
                    jAlert.success("安全问题设置成功！",null,null,function(){
                        location.hash="#page=basic?bread=安全中心";
                    });
                }else{
                    jAlert.success(data.msg);
                }
            })
        }
    });
    $("#answerquestion").on("click",function(){
        var q1=$("#q1question").html();
        var q2=$("#q2question").html();
        var q3=$("#q3question").html();
        var a1=$("#q1answer").val();
        var a2=$("#q2answer").val();
        var a3=$("#q3answer").val();
        var url="/dlapi/uc/user/safe/"+user.data.id+"/checkSafe";
        if(a1==''||a2==''||a3==''){
            jAlert.warn("答案不能为空");
        }else{
            DeelonService.postjSON(url,{q1:q1,q2:q2,q3:q3,a1:a1,a2:a2,a3:a3},function(data){
                if(data.code==0){
                    $("#q1").val("1");
                    $("#q2").val("2");
                    $("#q3").val("3");
                    $("#answer").show();
                    $("#answering").hide();
                }else{
                    jAlert.warn(data.msg);
                }
            })
        }
    });
    $("#getEmailLink").on('click',function(){
        if(user.data.email==null){
            jConfirm('您还没有绑定邮箱，请先去绑定！', '系统提示', function(r) {
                if(r){
                    location.hash="#page=email?bread=邮箱绑定";
                }
            });
        }else{

        }

    })


</script>